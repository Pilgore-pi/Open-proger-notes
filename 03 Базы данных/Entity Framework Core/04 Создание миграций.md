https://learn.microsoft.com/en-us/ef/core/managing-schemas/migrations/managing?tabs=vs

## Создание базы данных

Создание делается через "миграции". Для этого нужно выполнить команду в консоли менеджера пакетов (в Visual Studio):

```powershell
Add-Migration InitialCreate

// Удаление миграции выполняется через команду:
Remove-Migration
```

После выполнения миграции, будет сгенерирован код для создания всех сущностей и связей БД. При этом в проекте должна появиться папка "Migrations"

**Запуск миграции**

Это команда запустит все созданные миграции и создаст файл app.db:
```powershell
Update-Database
```

В IDE JetBrains Rider нет консоли менеджера пакетов, вместо нее используется специальный конструктор миграций, который можно вызвать в контекстном меню проекта (`ПКМ > Entity Framework Core`). Однако, чтобы использовать конструктор миграций, нужно установить расширение EF Core Tools

Универсальным способом является CLI `dotnet ef`


### Как работают миграции

Когда создается миграция, Entity Framework Core генерирует код, который описывает изменения в схеме базы данных. Эти изменения могут включать создание новых таблиц, добавление или удаление столбцов, изменение типов данных и т.д. Когда вы применяете миграцию, Entity Framework Core выполняет эти изменения в базе данных.

Применение миграций при каждом запуске приложения не должно удалять данные из базы данных, если миграции созданы и применяются правильно. Миграции в Entity Framework Core предназначены для управления изменениями в схеме базы данных без потери данных. Однако, есть несколько нюансов, которые стоит учитывать.

Применение миграций при запуске приложения — это обычная практика, которая позволяет автоматически обновлять схему базы данных до последней версии. Это особенно полезно в средах разработки и тестирования

#### Открытие файла `app.db`

Для октрытия файла потребуется специальное ПО, поддерживающее просмотр файлов БД, например [DB Browser for SQLite](https://sqlitebrowser.org/dl/)

## Reverse engineering

Для выполнения обратного проектирования, нужно выполнить специальную команду

```powershell
Scaffold-DbContext "строка подключения" провайдер_бд
```

Пример:

```powershell
Scaffold-DbContext "Data Source=D:\\app.db" Microsoft.EntityFrameworkCore.Sqlite
```

#DB #Dotnet #Dotnet/EntityFramework
