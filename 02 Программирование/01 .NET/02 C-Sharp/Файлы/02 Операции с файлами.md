При создании потоков, можно указывать желаемую кодировку (Encoding class).

> ДОБАВИТЬ ASYNC ОПЕРАЦИИ

| Файловая операция | Асинхронная версия | Описание |
| :-- | :-- | :-- |
| File.ReadAllText() | File.ReadAllTextAsync() | Читает весь текст из файла в строку |
| File.WriteAllText() | File.WriteAllTextAsync() | Записывает строку в файл, создаёт или перезаписывает файл |
| File.AppendAllText() | File.AppendAllTextAsync() | Добавляет строку текста в конец файла, создаёт файл, если его нет |
| File.ReadAllBytes() | File.ReadAllBytesAsync() | Читает все байты из файла в массив байт |
| File.WriteAllBytes() | File.WriteAllBytesAsync() | Записывает массив байт в файл (создаёт/перезаписывает) |
| File.ReadAllLines() | File.ReadAllLinesAsync() | Читает все строки из файла в массив строк |
| File.WriteAllLines() | File.WriteAllLinesAsync() | Записывает массив строк в файл (создаёт/перезаписывает) |
| File.AppendAllLines() | File.AppendAllLinesAsync() | Добавляет строки в конец файла, создаёт файл, если его нет |
| File.Copy() | — | Копирует файл в новое место |
| File.Delete() | — | Удаляет файл |
| File.Move() | — | Перемещает/переименовывает файл |
| File.Exists() | — | Проверяет существование файла |
| File.Replace() | — | Заменяет содержимое файла на содержимое другого файла |

| Потоковая операция | Описание |
| :-- | :-- |
| File.Create() | Создает файл и открывает поток |
| File.Open() | Открывает файл и поток для него |
| File.OpenRead() | Открывает файл для чтения и поток |
| File.OpenWrite() | Открывает файл для записи и поток |

К потоковым операциям нужно применять оператор `using` или вручную закрывать потоки через метод `FileStream.Close()`, но второй вариант менее безопасен в плане контроля и его следует использовать, только когда `using` не уместен

## Запись файла

С перезаписью:

```csharp
File.WriteAllText(path, text);
```

```cs
using var sw = File.CreateText(path)
sw.Write("text");
```

С указанием кодировки:

```csharp
using StreamWriter sw = new(filePath, false, encoding)
sw.Write("aaŠ");
```

Глобальный using:

```cs
using StreamWriter sw = File.CreateText(path);
sw.Write(text);
```

С дозаписью:

Дозапись текста:

```cs
File.AppendAllText(path, text);
```

Дозапись массива строк:

```cs
File.AppendAllLines(path, stringCollection);
```

```cs
using var sw = File.AppendText(path);
sw.Write(text);
```

## Чтение

Простое чтение с автоматическим закрытием потока:

```csharp
string text = File.ReadAllText(filePath);
```

Через создание потоков с помощью API класса `File`:

```cs
using var sr = File.OpenText(filePath);
text = sr.ReadToEnd();
```

Непосредственно через поток:

```cs
using StreamReader sr = new(filePath);
text = sr.ReadToEnd();
```

## Бинарные файловые потоки. Классы BinaryReader и BinaryWriter

> Класс **`BinaryReader`** из пространства имён System.IO в .NET предназначен для удобного и эффективного чтения примитивных типов данных (например, int, double, bool, string и др.) из бинарного потока. Он берёт на себя побайтное чтение и преобразование данных в нужный тип, перемещая внутренний указатель в потоке по мере чтения.

**Основные особенности BinaryReader:**

- Работает поверх любого потока (Stream), часто используется с FileStream для чтения из файлов.

- Предоставляет методы `ReadInt32()`, `ReadDouble()`, `ReadBoolean()`, `ReadString()` и другие для чтения конкретных типов.

- Метод `ReadString()` читает строку в формате, где сначала идёт длина (7-битное целое), затем последовательность символов в указанной кодировке (по умолчанию UTF-8).

- При создании можно указать кодировку символов и параметр, оставлять ли базовый поток открытым после закрытия BinaryReader.

- Реализует интерфейс `IDisposable`, поэтому рекомендуется использовать в блоке using для автоматического освобождения ресурсов.

```cs
using (var reader = new BinaryReader(File.Open("data.bin", FileMode.Open))) {
    int number  = reader.ReadInt32();
    double pi   = reader.ReadDouble();
    bool flag   = reader.ReadBoolean();
    string text = reader.ReadString();
    Console.WriteLine($"Int: {number}, Double: {pi}, Boolean: {flag}, String: {text}");
}
```

Класс BinaryReader является производительным инструментом для работы с бинарными потоками, особенно в задачах, где нужно структурировано читать данные произвольных примитивных типов без дополнительного парсинга или сериализации.

> Требует синхронизации порядка записи и чтения данных при использовании вместе с BinaryWriter

Основные характеристики и возможности BinaryWriter:

Конструкторы:
Вы создаёшь экземпляр, передавая Stream (например, FileStream), в который будет выполняться запись. Можно также указать кодировку символов (по умолчанию UTF-8) и флаг, оставлять ли поток открытым после закрытия BinaryWriter.

| Метод | Описание|
| :-- | :-- |
| `Write(<тип данных> value)` | `<тип данных>` может представлять собой любой базовый символьный и числовой типы, а также `ReadOnlySpan<char>`, `ReadOnlySpan<byte>` |
| `Write(string value)` | записывает строку в формате: длина + символы в указанной кодировке |
| `Flush()` | сбрасывает буфер и записывает данные в базовый поток |
| `Close()` | закрывает поток и освобождает ресурсы |

`BinaryWriter` обычно используют вместе с `FileStream` для записи бинарных файлов, или с любыми другими потоками (например, сетевые), когда нужно отправлять бинарные данные. При совместном использовании с классом `BinaryReader` можно легко записывать и считывать комплексные данные в бинарном формате, обеспечивая компактность и производительность.

#C-Sharp #C-Sharp/IDisposable #Files
