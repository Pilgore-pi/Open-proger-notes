> **Компиляция** — это процесс преобразования исходного кода, написанного на языке программирования высокого уровня (например, C#, F# или VB.NET), в форму, которую может выполнить компьютер. В .NET этот процесс многоступенчатый и отличается от классической компиляции в машинный код.

## Основные этапы компиляции в .NET

![https://dotnet.microsoft.com/blob-assets/images/illustrations/swimlane-architecture-framework.svg]

### 1 Преобразование исходного кода в промежуточный язык (IL)

Исходный код (.cs, .fs, .vb) компилируется компилятором (например, Roslyn для C#) в промежуточный язык — Common Intermediate Language (CIL или IL)

На этом этапе создаётся сборка (assembly) — файл `.dll` или `.exe`, содержащий:

- **IL-код**,
- **Метаданные** (описание типов, методов, атрибутов)
- **Манифест** (информация о сборке)

### 2 Проверка и валидация

IL-код и метаданные проходят валидацию на корректность (например, проверка типов, ссылок, структур данных)

Это обеспечивает безопасность и предотвращает выполнение вредоносного или некорректного кода

### 3 JIT-компиляция

При запуске программы CLR (Common Language Runtime) загружает сборку и компилирует IL-код в машинный код, специфичный для данной платформы (x86, x64, ARM и т.д.)

JIT-компилятор компилирует методы по мере их вызова (on-demand), что позволяет оптимизировать выполнение и экономить ресурсы

- Существуют разные виды JIT:
    - **Normal JIT** — стандартная компиляция по требованию
    - **Pre-JIT (NGen)** — предварительная компиляция в машинный код до запуска
    - **Tiered Compilation** — многоуровневая компиляция с оптимизациями на основе профилирования

### 4 Исполнение

- Скомпилированный машинный код выполняется *центральным процессором*
- CLR управляет памятью (Garbage Collector), безопасностью, обработкой исключений и другими аспектами выполнения.

#Programming #Dotnet #C-Sharp
