
> **Регистры накопления** предназначены для хранения и учета количественных изменений ресурсов (например, товаров, денег, материалов) в разрезе нескольких измерений (например, номенклатура, склад, подразделение)

Для регистра накопления платформа создает в базе данных таблицы, в которых будут накапливаться данные, поставляемые различными объектами ИБ.

Эти данные будут храниться в таблицах в виде отдельных записей, каждая из которых имеет одинаковую, заданную при конфигурировании регистра структуру

> Регистры накопления должны формироваться автоматически, а администраторы и программисты только анализировать их. Обычные пользователи не должны иметь доступа к ним

> **Ресурс** регистра накопления — это числовое значение, которое накапливается в регистре

> **Движение регистра накопления** — это запись со сведениями о совершенном событии, означающим изменение количественных характеристик объектов учета

Одна запись (экземпляр) регистра — это и есть движение. Движения можно наполнять дополнительной информацией, для этого можно создавать реквизиты в регистре

Структура движения регистра:

- Измерения
- Значения приращения ресурсов
- Регистратор (Ссылка на документ или другой объект, вызвавший изменения)
- Направление приращения (приход или расход)

**Регистратор** — источник события, который содержит информацию, необходимую для создания движений. Для регистра может быть определено множество регистраторов

> У регистра накопления всегда должен быть регистратор

**Когда происходит движение в регистр?**

— Чаще всего, при проведении документа

**Может ли посторонний объект, не являющийся регистратором совершать движения в регистр?**

## Структура объекта конфигурации


| Структурный элемент | Описание                                                                                                                |
| ------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| Измерения           | Измерения — это составной ключ, состоящий из свойств разных типов и идентифицирующий запись регистра среди всех записей |
| Ресурсы             | Для регистра накопления — числовые значения... Для регистра сведений — переменная любого типа...                        |
| Реквизиты           |                                                                                                                         |
| Формы               | Формы набора записей регистра, формы списка и произвольные формы, подчиненные регистру                                  |
| Команды             | Подчиненные регистру, команды                                                                                           |
| Макеты              | Макеты регистра                                                                                                         |

| Стандартные реквизиты | Описание                                                                  |
| --------------------- | ------------------------------------------------------------------------- |
| Период                | **`Дата`** и время записи регистра                                        |
| Регистратор           | **`ДокументСсылка.ИмяДокумента`** Источник движений                       |
| НомерСтроки           | Вместе с `Регистратором` идентифицирует запись регистра                   |
| Активность            | **`Булево`** Определяет будет ли учитываться запись регистра в его итогах |
| ВидДвижения           | **`ВидДвиженияНакопления { Приход, Расход }`**                            |

> Идентификатором регистра накопления является совокупность ссылки на регистратор и номер строки

## Разновидности регистров накопления

Регистры накопления могут быть двух видов:

- Регистры остатков
- Регистры оборотов

Для регистров остатков система всегда создает три виртуальные таблицы:

- Таблица остатков
- Таблицу оборотов
- Совокупная таблица остатков и оборотов

Для регистров оборотов система создает только одну виртуальную таблицу:

- Таблица оборотов

Оборотный регистр накопления очень похож на регистр остатков, но для него понятие «остаток» не имеет смысла. Оборотный регистр накапливает только обороты. В остальном оборотный регистр ничем не отличается от регистра остатков.

по каждому из измерений регистра накопления остатков ресурсы обязательно должны изменяться в обе стороны: приход и расход. Не должно существовать таких измерений, по которым осуществляется только приход или только расход.

Нарушение этого принципа построения регистров накопления будет вести к непроизводительному использованию ресурсов системы и как следствие – к замедлению работы и падению производительности

Для реквизитов же регистра этот принцип не важен. По реквизитам регистра ресурсы могут только приходоваться или только расходоваться.

Для регистров оборотов отсутствует параметр `ВидДвижения`, так как он не должен использоваться

----
## [Внутреннее устройство регистров](https://www.koderline.ru/expert/instruktsii/article-ispolzovanie-virtualnykh-tablits-1s-v-zaprosakh/)

Регистры состоят из двух таблиц, которые хранятся в базе данных, это **таблица движений** и **таблица итогов**.
Расчет таблицы итогов будет зависеть от вида регистра 1С, структура имеет следующий вид:

Посредством запроса 1С можно обратиться к движениям и к виртуальным таблицам 1С, доступ к итогам напрямую невозможен.

**Использование таблицы движений является крайне нежелательной, т.к. она содержит максимальное количество записей, обработка которых будет сильно нагружать систему.**

#1С #1С/Конфигурация/Регистры