> **Контейнеризация** — это технология, позволяющая упаковывать приложения со всеми необходимыми зависимостями в изолированные среды, называемые **контейнерами**. Контейнер содержит код приложения, библиотеки, среду выполнения и настройки. Это позволяет запускать приложения независимо от операционной системы и программного обеспечения хост-машин.

## Система контейнеризации Docker

**Docker** — популярная система контейнеризации, которая позволяет упаковывать и запускать приложения в изолированных средах. Используя Docker Compose (инструмент для [[Введение в системы оркестрации|оркестрации]] нескольких Docker-контейнеров), можно легко развертывать сложные системы.

## Зачем нужна контейнеризация

Представим, что у нас есть web-приложение, онлайн-переводчик, которое посещают сотни тысяч пользователей. Web-приложение состоит из нескольких ключевых компонентов:

- **Операционная система**, которая позволяет запускать приложение
- **Клиентское приложение** с графическим интерфейсом
- **ИИ-модель** для обработки запросов пользователей и генерации перевода
- **База данных**, в которой содержится информация о пользователях, истории запросов и словари различных естественных языков (русский, английский, немецкий и т. д.)
- **Python-библиотеки** для корректной работы ИИ модели

Все перечисленные компоненты располагаются на сервере, одиночном ПК с большими вычислительными мощностями

**Проблема 1**. Борьба за общие ресурсы в ОС

Так как все компоненты web-приложения находятся в одной ОС, то они разделяют общие ресурсы, за которые идет борьба и, если, например, ИИ-модель "перетягивает" на себя большую общих ресурсов, то их будет не хватать другим компонентам (клиентскому приложению и б)

## Как происходит контейнеризация?

Процесс контейнеризации включает создание образов контейнеров с помощью инструментов типа **Docker** или **Kubernetes**. Эти инструменты позволяют развертывать приложения на любой поддерживаемой платформе без изменений.

Контейнер — это виртуальное пространство, полностью обособленное от других систем и контейнеров.

- У каждого контейнера
    - своя файловая система,
    - свои сетевые интерфейсы (сокеты)
    - свои идентификаторы процессов
    - своя система контроля ресурсов
    - своя система доступа к ресурсам

- В основе контейнера лежит ядро операционной системы, поэтому контейнер может быть запущен на любой ОС, в основе которой лежит данное ядро ОС. Можно сказать, что контейнер — это упрощенная виртуальная машина

- Для каждого контейнера выделяются доступные аппаратные мощности (количество ядер, доступная память и сеть)

Приложение Docker Desktop позволяет запускать контейнеры в операционной системе, у которой ядро ОС отличается от ядра контейнера посредством создания виртуальной среды

#### Образы (Images)

**Образ** — это шаблон, доступный только для чтения, содержащий всю конфигурацию и зависимости, необходимые для запуска приложения в контейнере

**Характеристики образа:**

1. **Слоистая структура**: Образ состоит из набора слоев (`levels`), которые объединяются с помощью `union file system`. Каждый слой представляет собой результат промежуточных изменений и доступен только для чтения

2. **Неизменяемость**: Образы не могут быть изменены напрямую; вместо этого создаются новые слои при обновлении или модификации образа

3. **Использование Dockerfile**: Для создания собственных образов используется файл `Dockerfile`, содержащий команды и инструкции по сборке образа

4. **Хранение в реестре**: Готовые образы хранятся в реестрах, таких как Docker Hub, где их можно скачать или загрузить

Образ является отправной точкой для создания контейнеров — экземпляров этого шаблона с возможностью записи данных во время работы

#### Язык YAML

Для управления и описания конфигураций в системах контейнеризации часто используется язык **YAML (Yet Another Markup Language)**. [[YAML|YAML]] — это человекопонимаемый формат для хранения данных и широко применяется для конфигурационных файлов и управления инфраструктурой как код (IaC).

Пример простого файла `docker-compose.yml`, написанного на YAML:

```yaml
version: '3'
services:
    web:
        build: .
        ports:
            - "80:80"
```

Этот пример показывает сервис `web`, который строится из текущего каталога (`.`) и пробрасывает порт `80` с хоста на порт `80` внутри контейнера.

#### Пример 1: Развертывание веб-приложения с базой данных

Используя файл `docker-compose.yml`, можно одновременно запустить несколько служб:

```yaml
version: '3'
services:
    web:
        build: .
        ports:
            - "3000:3000"
        depends_on:
            - db
        db:
            image: postgres
```

Этот пример демонстрирует развертывание веб-приложения (`web`) вместе с базой данных PostgreSQL (`db`). Зависимость между сервисами гарантирует правильный порядок их запуска.

#### Пример 2: Микросервисная архитектура

Docker Compose также идеально подходит для микросервисных архитектур:

```yaml
version: '3'
services:
    frontend:
        build: ./frontend
        ports: - "80:80"
    backend:
        build: ./backend
```

Здесь описаны два микросервиса (`frontend` и `backend`) как части одного приложения. Такая структура позволяет гибко управлять несколькими компонентами системы одновременно.

Таким образом, используя технологию контейнеризации через инструменты типа Docker, разработчики могут создавать масштабируемые и гибкие решения для своих проектов.

#Containerization #Containerization/Docker