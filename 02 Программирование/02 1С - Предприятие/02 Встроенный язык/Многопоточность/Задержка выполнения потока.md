
На момент 08.08.2024 в 1С отсутствует функция, выполняющая задержку выполнения кода в основном и фоновых потоках, поэтому приходится использовать обходные пути для реализации задержек.

Существует реализация задержки, основанная на создании и выполнении скрипта, который выполняет ожидание без нагрузки на процессор

```bsl
Процедура Задержка(Секунд) Экспорт  
    СтрокаЗапроса = "ping -n 1 -w " + Формат(1000 * Секунд, "ЧГ=0") + " 127.255.255.255";  
    WshShell = Новый COMОбъект("WScript.Shell");  
    WshShell.Run(СтрокаЗапроса, 0, -1);
КонецПроцедуры
```

Как вариант, можно запускать фоновые задания на определенный срок, и после их завершения продолжать работу системы


----

## Обработчик ожидания

[Источник](https://infostart.ru/1c/articles/1503370/)

Механизм подключения обработчика ожидания появился в 1С 8.0.

С точки зрения платформы, это поддерживаемая процессом rphost, единая для сеанса, виртуальная таблица ключей, таймаутов и текущих значений таймера

* Ключ - хеш от ID модуля, откуда был выполнен вызов, ID модуля вызываемой процедуры обработчика, и имени процедуры обработчика. Идентификаторы модулей можно увидеть, выгрузив конфигурацию в файлы.
* Таймаут - число, рассчитывается в миллисекундах.
* Текущее значение таймера - момент предыдущего срабатывания, дата/время с миллисекундами. Таймеры отталкиваются от текущей даты/времени сеанса в момент компиляции подключения обработчика или реинициализации таблицы. Эта таблица обслуживается специальным обработчиком, который не является сервисом кластера, а просто часть механизма платформы

> Обработчик не учитывает успешность вызова и выполнения вызываемой процедуры

Обработчик можно запускать и останавливать в форме, экземпляр которой создан, но не открыт; в любой момент, пока её контекст есть в некой переменной

Запускать и останавливать придётся отдельными экспортными процедурами, т.к. обращение "НеоткрытаяФорма.ПодключитьОбработчикОжидания" игнорируется без генерации исключения. С уничтожением переменной формы останавливается и обработчик - поэтому следует быть внимательными, чтобы после закрытия запустившей формы или команды не случилось зависания этой переменной в памяти сеанса

### Подключение обработчика ожидания

```bsl
ПодключитьОбработчикОжидания(
    ИмяПроцедуры,
    ИнтервалВСекундах,        // с точностью до 0,1 секунды
    Однократно                // Если ИнтервалВСекундах < 1, то Однократно должно быть Истина
);
```

> Не следует использовать данный обработчик в качестве таймера. Фактический интервал срабатывания может отличаться от указанного

Подключает вызов указанной процедуры модуля приложения (модуля обычного приложения) или глобального общего модуля через определенный интервал времени. Вызов будет осуществляться только в "состоянии покоя", то есть в тот момент, когда программа не выполняет никаких действий.
Во время временной блокировки, вызванной методом ЗаблокироватьРаботуПользователя или соответствующей командой "Временная блокировка", обработчики ожидания не выполняются

#### Параметр ИмяПроцедуры

Представляет имя экспортируемой процедуры модуля

- Процедура должна располагаться на клиенте
- Процедура не должна содержать параметров

#### Параметр ИнтервалВСекундах

Регламентирует, через какие промежутки времени, будет вызвана процедура

- Измеряется в секундах с точностью до десятых

#### Параметр Однократно

Если `Истина`, то обработчик выполняется один раз.

### Отключение обработчика ожидания

Отключает подключенный ранее при помощи процедуры `ПодключитьОбработчикОжидания` вызов процедуры через определенный интервал времени

```bsl
ОтключитьОбработчикОжидания(ИмяПроцедуры);
```



#1С #1С/Многопоточность
