
**Процессор (CPU, Central Processing Unit, ЦПУ)** — центральное процессорное устройство, интегральная схема, исполняющая машинные инструкции программ. Процессор состоит из миллиардов транзисторов, сопоставимых с молекулами ДНК, которые объединяются в логические вентили, позволяющие выполнять арифметические операции (сложение, умножение), сравнение чисел и логические операции. Данные для обработки берутся из оперативной памяти, однако из-за её относительной медлительности используется кэш-память для ускорения доступа к часто используемым данным.

## Архитектуры процессоров

Существуют три основных архитектуры процессоров, определяющие набор поддерживаемых машинных команд и совместимость с программным обеспечением:

1. **x86/x64** — архитектура для персональных компьютеров (Intel, AMD). Поддерживает 32-битные (x86) и 64-битные (x64) инструкции

2. **ARM** — архитектура для мобильных устройств, планшетов и встраиваемых систем (Apple, Qualcomm, MediaTek). Характеризуется низким энергопотреблением

3. **AVR** — архитектура для микроконтроллеров и электронных устройств (Atmel). Используется в IoT (интернет вещей) и встраиваемых системах

> **Разрядность** — величина, определяющая размер машинного слова (максимальное количество бит, обрабатываемое процессором за один такт). В современных ПК используются 64-битные процессоры с размером регистра 64 бита

## Кэш-память

Оперативная память значительно медленнее процессора, поэтому для сокращения простоев используется многоуровневая кэш-память:

> **Кэш** — сверхбыстрая память внутри процессора, хранящая копии часто используемых данных из оперативной памяти для ускорения доступа

**Уровни кэша (от быстрого к медленному):**

- **L1 (Level 1)** — самый быстрый, объём 32-64 КБ на ядро, скорость ~120 ГБ/с, разделён на кэш инструкций (I-cache) и кэш данных (D-cache)

- **L2 (Level 2)** — средний, объём 256-512 КБ на ядро, скорость ~60 ГБ/с, обычно приватный для каждого ядра

- **L3 (Level 3)** — самый объёмный, объём 4-32 МБ, скорость ~20 ГБ/с, общий для всех ядер процессора

- **L4 (Level 4)** — редко встречается, используется в некоторых серверных и мобильных процессорах

Принцип работы: при обращении процессора к памяти сначала проверяется L1, затем L2, затем L3, и только потом оперативная память. Чем больше кэш, тем реже процессор обращается к медленной оперативной памяти, что повышает производительность.

## Регистры процессора

> **Регистр** — сверхбыстрая оперативная память (СОЗУ) внутри процессора, предназначенная для хранения промежуточных результатов вычислений и управления работой CPU

Регистры представляют собой цифровые электронные схемы для временного хранения двоичных чисел. Доступ к значениям в регистрах в несколько раз быстрее, чем доступ к ячейкам оперативной памяти (даже кэшированным), однако суммарный объём регистров минимален (обычно 64-256 байт), что несоизмеримо с объёмом оперативной памяти (4-64 ГБ).

**Типы регистров:**

- **Регистры общего назначения** — доступны программам для хранения данных и адресов
- **Управляющие регистры** — доступны только операционной системе для управления режимом работы CPU
- **Специальные регистры** — счётчик команд (Program Counter), указатель стека (Stack Pointer) и другие

## Тактовая частота и множители

> **Тактовая частота** — количество операций, выполняемых процессором в секунду, измеряется в герцах (Гц, МГц, ГГц)

Тактовая частота процессора рассчитывается по формуле:

```text
Тактовая_частота = Базовая_частота × Множитель
```

**Компоненты формулы:**

1. **Базовая частота (BCLK)** — опорная частота системной шины, обычно 100 МГц (Intel) или 100 МГц (AMD), устанавливается в BIOS и редко меняется

2. **Множитель (CPU Multiplier)** — коэффициент увеличения базовой частоты, каждое ядро может использовать свой множитель для динамической подстройки частоты под нагрузку

3. **Напряжение ядра (Core Voltage)** — электрическое напряжение, подаваемое на процессор. Повышенное напряжение необходимо для стабильной работы на высоких частотах, но увеличивает тепловыделение и деградацию кристалла

**Динамическая подстройка частоты:**

- **Intel Turbo Boost** — автоматическое повышение множителя при высокой нагрузке и низкой температуре
- **AMD Precision Boost** — аналогичная технология для процессоров Ryzen
- **Понижение частоты** — при низкой нагрузке частота снижается для экономии энергии
## Многопоточность и гиперпоточность

> **Поток (Thread)** — последовательность инструкций, выполняемых процессором. Один процесс может состоять из нескольких потоков, выполняемых параллельно на разных ядрах или поочередно на одном ядре

> **Ядро (Core)** — физическая единица процессора, способная независимо выполнять инструкции. Каждое ядро имеет собственный набор регистров, L1 кэш и контроллер прерываний

**Гиперпоточность (Hyper-Threading, HTT)** — технология Intel, позволяющая одному физическому ядру выполнять два потока одновременно:

- Каждое физическое ядро содержит два набора регистров и два контроллера прерываний
- Второй поток использует ресурсы ядра в моменты, когда первый поток ждёт данных из памяти
- Не может полностью заменить физическое ядро, эффективность зависит от типа программы (обычно 20-30% прирост производительности)

**Логические процессоры:**

Операционная система и программы видят логические процессоры (ядра + потоки). Например, процессор с 4 физическими ядрами и гиперпоточностью отображается как 8 логических процессоров.

| Конфигурация | Физические ядра | Логические процессоры |
| :----------- | :--------------- | :-------------------- |
| 4C/4T        | 4                | 4                     |
| 4C/8T        | 4                | 8 (с гиперпоточностью) |
| 8C/16T       | 8                | 16 (с гиперпоточностью) |

## Прерывания и исключения

> **Прерывание** — сигнал, приостанавливающий текущий процесс для выполнения более приоритетного обработчика прерываний. По завершении обработчика выполнение прерванного процесса продолжается

**Типы прерываний:**

1. **Программные прерывания** — генерируются самой программой через специальные инструкции (INT)

2. **Аппаратные прерывания** — генерируются внешними устройствами (клавиатура, мышь, сетевая карта, таймер)

3. **Исключения (Exception)** — генерируются самим процессором при обнаружении ошибок:
   - Деление на ноль
   - Переполнение регистра
   - Выход за пределы памяти (Page Fault)
   - Ошибка защиты памяти
   - Недопустимая инструкция
   - Отладочное исключение (Breakpoint)

4. **Немаскируемые прерывания (NMI)** — критические ошибки оборудования (ошибки ОЗУ, отказ питания), не могут быть отключены программой

## Уровни привилегий и режимы работы

Процессор поддерживает несколько уровней доступа для защиты системы:

**Уровни привилегий (Ring levels):**

- **Ring 0 (Kernel Mode)** — полный контроль над процессором, доступ ко всем инструкциям и памяти. Используется операционной системой и драйверами

- **Ring 1-2** — промежуточные уровни, редко используются в современных ОС

- **Ring 3 (User Mode)** — ограниченный доступ, используется прикладными программами. Доступ к защищённым инструкциям и памяти других процессов запрещён

При попытке прикладной программы выполнить привилегированную операцию генерируется исключение, и управление передаётся ОС.

**Режимы работы:**

- **Real Mode** — режим реальной адресации, используется при загрузке компьютера (BIOS)
- **Protected Mode** — защищённый режим с виртуальной памятью и многозадачностью (современные ОС)
- **Long Mode (x64)** — 64-битный режим для процессоров x86-64

## Процессы и потоки в ОС

При запуске компьютера BIOS загружает первый сектор загрузочного диска в память и передаёт управление процессору, который начинает выполнять операционную систему.

> **Процесс** — экземпляр выполняемой программы с собственным адресным пространством памяти, регистрами и ресурсами

> **Поток** — единица выполнения внутри процесса, разделяющая память и ресурсы с другими потоками процесса

**Организация памяти для процессов:**

Операционная система разделяет память между ОС (привилегированная) и прикладными программами (пользовательская). Каждому процессу выделяется отдельное виртуальное адресное пространство, изолированное от других процессов.

**Многозадачность:**

Процессы и потоки не выполняются одновременно (на однопроцессорной системе). Операционная система использует вытесняющую многозадачность:

1. Процесс выполняется некоторое время (квант времени, обычно 10-100 мс)
2. ОС сохраняет состояние процесса (регистры, счётчик команд, флаги)
3. ОС переключается на другой процесс
4. При следующем переключении на первый процесс его состояние восстанавливается

На многопроцессорных системах разные потоки могут выполняться на разных ядрах действительно одновременно.


## Поколения процессоров Intel

Первое поколение Westmere подключается через сокет LGA 1156

Второе и третье поколения Sandy Bridge & Ivy Bridge подключаются через сокет LGA 1155. Второе поколение стало последним, в котором крышка процессора фиксировалась припоем, в третьем она уже посажена на термопасту. Для процессоров второго поколения вышло несколько МП с чипсетами: H61 H67 B65 P67 Q65 Q67 Z68; третьего поколения: B75 B77 Q75 Q77 H75 H77 P75 P77 Z75 Z77

Четвертое поколение Haswell (2013) – сокет LGA 1150. Чипсеты поколения: H81 Q87 B85 H87 Z85 X99

Пятое поколение Broadwell (2014) – сокет LGA 1150. Чипсеты H97 и Z97 X99 подходят также и к четвертому поколению.

Шестое поколение Sky Lake (2015) – сокет LGA  1151. Чипсеты: H110 H170 B150 Q170 Z170 X299

Седьмое поколение Kaby Lake (2017) – сокет LGA  1151. Чипсеты: H110 H270 B250 Q270 Z270 X299

Восьмое поколение Coffee Lake (2017) – сокет LGA 1151v2. Чипсеты: Z370. Совместимы только с чипсетами 300-й серии, процессоры 6 и 7 поколения нельзя установить в сокет 1151v2

Девятое поколение Coffee Lake Refresh (2018) – сокет LGA 1151v2. Чипсеты: H310(C) H370 B360 Q370 Z370 Z390

... Позволяет работать со 128 Гб оперативной памяти

Десятое поколение Comet Lake (2019) – сокет LGA 1200. Чипсеты: H410 H470 B460 Q470 Z490.

Ice Lake – мобильные процессоры, используемые в ноутбуках, смартфонах и планшетах

Одиннадцатое поколение Rocket Lake (2021)

Tiger Lake (2020) – поколение мобильных процессоров

## Разъяснение названий процессоров Intel

**`Intel Core i9-10900K`**

- `Intel` — компанияя
- `Core` — линейка
- `i9` — серия процессоров
- `10` — Поколение
- `900` — Номер
- `K` — Индекс (суффикс)

#### Индексы

| Индекс   | Описание                                                                                           |
| -------- | -------------------------------------------------------------------------------------------------- |
| **M**    | мобильный. Имеет меньшую частоту и тепловыделение, используется в ноутбуках, смартфонах, планшетах |
| **U**    | ультрамобильный. Тепловыделение на уровне 15 Вт.                                                   |
| **Y**    | экстремально низкое потребление ~11,5 Вт                                                           |
| **S, L** | энергоэффективный. Уклон на производительность со сниженным энергопотреблением (S).                |
| **T**    | высокоэнергоэффективный. Низкие потребление и частота                                              |
| **H**    | улучшенное графическое ядро                                                                        |
| **F**    | без встроенного видеочипа                                                                          |
| **Q**    | Четырехъядерный                                                                                    |
| **R**    | процы в корпусе BGA и с более производительной графикой                                            |
| **E**    | стандартный; наличие варианта для встраиваемых систем (QE, ME, LE, UE)                             |
| **X**    | экстремальный (X-series). Высокопроизводительные процессоры с разблокированным множителем          |
| **MX**   | экстремальный мобильный процессор                                                                  |
| **K**    | разблокированный множитель                                                                         |
| **P**    | без автоматического разгона                                                                        |

Интересный Факт

Cerebro CS-1 – процессор с 400 000 ядер и 1,2 трлн транзисторов!*

18 Гб кэш-памяти L2, 20 КВт! 16нм техпроцесс

### Поколения процессоров AMD

Компания AMD развилась из Intel благодаря законодательству США, которое негативно относилось к монополиям. Но позже Intel перестал делиться технологиями с AMD, и на сегодняшний день это две независимо развивающихся компании.

До 2011 года были выпущены процессоры пяти поколений 5-10 (K5-K10). В октябре 2011 года была создана новая архитектура – Bulldozer. В то время, как у Intel было 2е поколение. Позже вышло новое 16 поколение с архитектурой Zen.

**`AMD Ryzen 5 2600`**

- `AMD` — производитель
- `Ryzen` — линейка
- `5` — серия
- `2` — поколение
- `600` — номер

## Характеристики процессора

- Сокет
- Количество ядер / потоков
- Частота / в режиме Turbo
- Кэш L1 L2 L3
- Техпроцесс (нм)
- TDP
- Максимальная температура
- Наличие встроенной графики
- Поддерживаемый объем оперативной памяти
- Поддерживаемая частота оперативной памяти

#Компьютерная_инженерия