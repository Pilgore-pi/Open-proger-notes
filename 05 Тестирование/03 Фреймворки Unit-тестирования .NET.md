Назад: [[02 Модульное тестирование]]

[Источник](https://daily.dev/blog/nunit-vs-xunit-vs-mstest-net-unit-testing-framework-comparison)

Здесь рассматриваются 3 популярных фреймворка для Unit-тестирования приложений .NET: MSTest, xUnit, NUnit

| Фреймворк  | Подходит для                                                         | Ключевые особенности                                                      |
| ---------- | -------------------------------------------------------------------- | ------------------------------------------------------------------------- |
| **NUnit**  | Большие и сложные проекты                                            | Богатые возможности, большое сообщество                                   |
| **xUnit**  | Современные проекты .NET Core/.NET 5+                                | Простой, быстрый, создан для параллельного выполнения; богатое сообщество |
| **MSTest** | Команд разработчиков, значительно вложившихся в экосистему Microsoft | Хорошо интегрирован в Visual Studio                                       |

Быстрое сравнение:

| Характеристика                                       | NUnit                                      | xUnit                                    | MSTest                                |
| ---------------------------------------------------- | ------------------------------------------ | ---------------------------------------- | ------------------------------------- |
| Синтаксис                                            | `[TestFixture]`, `[Test]`                  | `[Fact]`, `[Theory]`                     | `[TestClass]`, `[TestMethod]`         |
| Логика "перед каждым тестом" и "после каждого теста" | `[SetUp]`, `[TearDown]`                    | Constructor, IDisposable                 | `[TestInitialize]`, `[TestCleanup]`   |
| Параметризируемые тесты                              | Атрибут `[TestCase(...)]`                  | Атрибуты `[Theory]`, `[InlineData(...)]` | Атрибут `[DataRow(...)]`              |
| Группировка тестов                                   | Атрибут `[TestFixture]`                    | Не требует спец. атрибутов               | Атрибут `[TestClass]`                 |
| Параллельное выполнение                              | Нужно применить атрибут `[Parallelizable]` | Используется по умолчанию                | Нужно настраивать конфигурацию сборки |
| Использование ресурсов                               | Среднее                                    | Низкое                                   | Среднее                               |
| Поддержка сообществом                                | Большая                                    | Очень большая                            | Хорошая                               |

## Что представляют собой фреймворки для Unit-тестирования

Фреймворки для Unit-тестирования — это инструменты для разработчиков, помогающие тестировать небольшие части кода в проектах .NET. Фреймворки упрощают создание, управление и запуск тестов для конкретных участков кода, таких как классы и методы.

Фреймворк для Unit-тестирования предоставляет:

- Способ создания тестовых кейсов (случаев)
- Инструменты проверки кода
- Функционал для настройки и очистки тестируемых сред

### NUnit

**NUnit** — один из самых старых и распространенных фреймворков Unit-тестирования.

NUnit был создан как замена [JUnit](https://junit.org/) (инструмент для Unit-тестирования в Java) для .NET. С момента разработки было выпущено много обновлений, а версия NUnit 3.x была переписана с нуля

| Особенность               | Описание                                                                                                                      |
| ------------------------- | ----------------------------------------------------------------------------------------------------------------------------- |
| Библиотека проверки кода  | Множество способов проверить работоспособность кода                                                                           |
| Параметризируемые тесты   | Возможность запускать тесты с разными входными данными, с помощью атрибутов `[TestCase]`, `[TestCaseSource]` и`[ValueSource]` |
| Параллельное тестирование | Запуск нескольких тестов одновременно (атрибут `[Parallelizable]`)                                                            |
| Организация тестов        | Use `[TestFixture]`, `[SetUp]` и `[TearDown]` для организации тестов                                                          |
| Пользовательские атрибуты | Возможность создания собственных атрибутов, расширяющих возможности NUnit                                                     |

```csharp
[TestFixture]
public class CalculatorTests {
    private Calculator _calculator;
    
    [SetUp] public void Setup() {
        _calculator = new Calculator();
    }
        
    [Test] public void Add_WhenGivenTwoNumbers_ReturnsSum() {
        // Arrange
        int a = 2, b = 3;
        
        // Act
        int result = _calculator.Add(a, b);
        
        // Assert
        Assert.That(result, Is.EqualTo(5));
    }
        
    [TestCase(1, 2, 3), TestCase(0, 0, 0), TestCase(-1, 1, 0)]
    public void Add_WhenGivenMultipleInputs_ReturnsCorrectSum(int a, int b, int expected) {
        int result = _calculator.Add(a, b);
        Assert.That(result, Is.EqualTo(expected));
    }
}
```

| Преимущества                                | Недостатки                                        |
| ------------------------------------------- | ------------------------------------------------- |
| Богатый функционал                          | Может быть трудным в изучении                     |
| Большое сообщество                          | Не лучшим образом может работать с IDE            |
| Возможность параллельного выполнения тестов |                                                   |
| Множество способов проверки результатов     | Может быть многословным для простых тестов        |
| Гибкая настройка тестов                     | Настройка может быть усложнена для больших тестов |

## xUnit

Фреймоворк создан разработчиками NUnit. Целью фреймворка является простота использования и внесения изменений.

### Ключевые особенности

| Особенности                     | Описание                                     |
| ------------------------------- | -------------------------------------------- |
| Атрибуты `[Fact]` и `[Theory]`  | Используются для пометки тестируемых методов |
| Инъекция конструкторов          | Для настройки тестов                         |
| Поддержка специальных атрибутов | Для изменения поведения теста                |
| Параллельное тестирование       | Позволяет выполнять тесты быстрее            |

### Примеры использования

```csharp
public class MyTests {
    [Fact] public void Add_WhenGivenTwoNumbers_ReturnsSum() {
        // Arrange
        int a = 2, b = 3;
        
        // Act
        int result = a + b;
        
        // Assert
        Assert.Equal(5, result);
    }
}
```

```csharp
public class MyTests {
    [Theory, InlineData(1, 2, 3), InlineData(0, 0, 0), InlineData(-1, 1, 0)]
    public void Add_WhenGivenMultipleInputs_ReturnsCorrectSum(int a, int b, int expected) {
        int result = a + b;
        Assert.Equal(expected, result);
    }
}
```

| Преимущества                   | Недостатки                                                                 |
| ------------------------------ | -------------------------------------------------------------------------- |
| Легкость в использовании       | Требует времени на изучение                                                |
| Легкость во внесении изменений | Меньше аддонов                                                             |
| Тесты выполняются быстро       | Для некоторых проверок, необходимо использовать дополнительные инструменты |

## MS Test

**MSTest** — инструмент для Unit-тестирования от Microsoft для .NET. Фреймворк создан в 2005 году, специально для Visual Studio, но также поддерживаются другие IDE. На текущий момент, MSTest V2 является проектом с открытым исходным кодом и поддерживает Windows, Linux, и Mac OS.

| Атрибут            | Описание                                                |
| ------------------ | ------------------------------------------------------- |
| `[TestClass]`      | Помечает класс для тестирования                         |
| `[TestMethod]`     | Помечает метод для тестирования                         |
| `[TestInitialize]` | Код, выполняемый перед каждым тестом                    |
| `[TestCleanup]`    | Код, выполняемый после каждого теста                    |
| `[DataRow]`        | Позволяет выполнять тесты с различными входными данными |

### Примеры использования

```csharp
[TestClass]
public class MathTests {
    [TestMethod]
    public void Add_WhenGivenTwoIntegers_ReturnsSum() {
        // Arrange
        int a = 2, b = 3;
        
        // Act
        int result = a + b;
        
        // Assert
        Assert.AreEqual(5, result);
    }
}
```

Применение разных входных данных для теста:

```csharp
[TestClass]
public class MathTests {
    [TestMethod, DataRow(2, 3, 5), DataRow(0, 0, 0), DataRow(-1, 1, 0)]
    public void Add_WhenGivenMultipleInputs_ReturnsCorrectSum(int a, int b, int expected) {
        int result = a + b;
        Assert.AreEqual(expected, result);
    }
}
```

| Преимущества                         | Недостатки                                         |
| ------------------------------------ | -------------------------------------------------- |
| Отлично интегрирован с Visual Studio | Преимущественно, для Windows разработки            |
| Прост для разработчиков Microsoft    | Менее гибок, по сравнению с другими фреймворками   |
| Полезные инструменты в Visual Studio | Зависимость от Visual Studio                       |
|                                      | Не такое большое коммьюнити, как у NUnit или xUnit |
|                                      | Меньше продвинутых инструментов                    |

#Testing #Testing/Unit_testing #Dotnet