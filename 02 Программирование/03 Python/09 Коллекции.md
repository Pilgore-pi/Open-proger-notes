https://habr.com/ru/articles/319164/

Коллекции в Python — это структуры данных, предназначенные для хранения группы элементов. Они подразделяются на следующие категории:

1. **Последовательности (sequences)**
    - Изменяемые (mutable): `list` (список)
    - Неизменяемые (immutable): `str` (строка), `tuple` (кортеж)
2. **Множества (sets)**
    - Изменяемые: `set` (множество)
    - Неизменяемые: `frozenset` (замороженное множество)
3. **Отображения (Mappings)**
    - Изменяемые: `dict` (словарь)

## Список (list)

Это изменяемая последовательность, основанная на динамическом массиве. Доступ к элементу происходит за O(1). Список хранит данные в скрытом массиве, который автоматически расширяется при необходимости.

```python
my_list = ['a', 'b', 'c', 'd', 'e', 'f']
my_list = [1, 2, 3]
my_list.append(4)
my_list.append(5)
```

| Метод | Возврат | Описание |
| :--- | :--- | :--- |
| `append(item)` | `None` | Добавляет элемент в конец списка |
| `extend(iterable)` | `None` | Добавляет все элементы итерируемого объекта в конец списка |
| `insert(index, item)` | `None` | Вставляет элемент по указанному индексу |
| `remove(item)` | `None` | Удаляет первый элемент с заданным значением |
| `pop(index=-1)` | элемент | Удаляет и возвращает элемент по индексу (по умолчанию последний) |
| `clear()` | `None` | Удаляет все элементы из списка |
| `index(item)` | `int` | Возвращает индекс первого элемента с заданным значением |
| `count(item)` | `int` | Возвращает количество элементов с заданным значением |
| `sort(reverse=False)` | `None` | Сортирует элементы списка |
| `reverse()` | `None` | Разворачивает список |
| `copy()` | `list` | Возвращает неглубокую копию списка |

## Кортеж (tuple)

Это неизменяемая последовательность. После создания кортеж нельзя изменять. Доступ к элементу происходит за O(1). Кортежи часто используются как ключи словарей благодаря неизменяемости.

```python
my_tuple = ('a', 'b', 'c')
my_tuple = (1, 2, 3)
# Кортеж с одним элементом требует запятой
single_tuple = (1,)
```

| Метод | Возврат | Описание |
| :--- | :--- | :--- |
| `index(item)` | `int` | Возвращает индекс первого элемента с заданным значением |
| `count(item)` | `int` | Возвращает количество элементов с заданным значением |
| `copy()` | `tuple` | Возвращает неглубокую копию кортежа |

**Важное замечание:** Кортеж может содержать неизменяемые элементы. Если кортеж содержит изменяемый элемент (например, список), он не может быть ключом словаря, так как не является хешируемым:

```python
a = (1, [2, 3], 4)
b = {a: 1}  # TypeError: unhashable type: 'list'
```

## Строка (str)

Это неизменяемая последовательность символов. Строки часто обрабатываются как коллекции, где каждый символ — элемент.

```python
my_str = 'hello'
print(my_str[0])  # 'h'
print('ell' in my_str)  # True
```

| Метод | Возврат | Описание |
| :--- | :--- | :--- |
| `index(substring)` | `int` | Возвращает индекс первого вхождения подстроки |
| `count(substring)` | `int` | Возвращает количество вхождений подстроки |
| `find(substring)` | `int` | Возвращает индекс подстроки или -1, если не найдена |
| `replace(old, new)` | `str` | Возвращает новую строку с заменённой подстрокой |
| `split(separator)` | `list` | Разбивает строку на список по разделителю |
| `join(iterable)` | `str` | Объединяет элементы итерируемого объекта в строку |
| `upper()` | `str` | Возвращает строку в верхнем регистре |
| `lower()` | `str` | Возвращает строку в нижнем регистре |
| `strip()` | `str` | Удаляет пробелы в начале и конце строки |

## Множество (set)

Это изменяемая неупорядоченная коллекция уникальных элементов. Множество не поддерживает индексацию. Элементы должны быть хешируемыми.

```python
my_set = {1, 2, 3}
my_set = set()  # Пустое множество
my_set.add(1)
my_set.add(2)
```

| Метод | Возврат | Описание |
| :--- | :--- | :--- |
| `add(item)` | `None` | Добавляет элемент в множество |
| `remove(item)` | `None` | Удаляет элемент; вызывает ошибку, если элемента нет |
| `discard(item)` | `None` | Удаляет элемент; не вызывает ошибку, если элемента нет |
| `pop()` | элемент | Удаляет и возвращает произвольный элемент |
| `clear()` | `None` | Удаляет все элементы из множества |
| `copy()` | `set` | Возвращает неглубокую копию множества |
| `union(other)` | `set` | Возвращает объединение множеств |
| `intersection(other)` | `set` | Возвращает пересечение множеств |
| `difference(other)` | `set` | Возвращает разность множеств |
| `symmetric_difference(other)` | `set` | Возвращает симметрическую разность |
| `isdisjoint(other)` | `bool` | Истина, если множества не имеют общих элементов |
| `issubset(other)` | `bool` | Истина, если данное множество — подмножество другого |
| `issuperset(other)` | `bool` | Истина, если данное множество — надмножество другого |

```python
set_a = {1, 2, 3}
set_b = {2, 1}
set_c = {4}

print(set_a.isdisjoint(set_c))  # True
print(set_b.issubset(set_a))    # True
print(set_a.issuperset(set_b))  # True
```

## Замороженное множество (frozenset)

Это неизменяемая неупорядоченная коллекция уникальных элементов. После создания не может быть изменено. Может использоваться как ключ словаря.

```python
my_frozenset = frozenset([1, 2, 3])
my_frozenset = frozenset()  # Пустое замороженное множество
```

| Метод | Возврат | Описание |
| :--- | :--- | :--- |
| `copy()` | `frozenset` | Возвращает неглубокую копию |
| `union(other)` | `frozenset` | Возвращает объединение множеств |
| `intersection(other)` | `frozenset` | Возвращает пересечение множеств |
| `difference(other)` | `frozenset` | Возвращает разность множеств |
| `symmetric_difference(other)` | `frozenset` | Возвращает симметрическую разность |
| `isdisjoint(other)` | `bool` | Истина, если множества не имеют общих элементов |
| `issubset(other)` | `bool` | Истина, если данное множество — подмножество другого |
| `issuperset(other)` | `bool` | Истина, если данное множество — надмножество другого |

## Словарь (dict)

Это изменяемое отображение пар ключ-значение. Ключи должны быть уникальными и хешируемыми. Значения могут быть любыми и неуникальными. Начиная с Python 3.7, словари сохраняют порядок вставки элементов.

```python
my_dict = {'a': 1, 'b': 2, 'c': 3}
my_dict = {}  # Пустой словарь
my_dict['a'] = 1
```

**Важное замечание:** Для того чтобы объект мог быть ключом словаря, он должен быть хешируемым. Кортеж может быть ключом только если все его элементы хешируемы:

```python
my_dict = {('a', 1): 'value'}  # OK
my_dict = {('a', [1, 2]): 'value'}  # TypeError: unhashable type: 'list'
```

| Метод | Возврат | Описание |
| :--- | :--- | :--- |
| `get(key, default=None)` | значение | Возвращает значение по ключу или значение по умолчанию |
| `keys()` | `dict_keys` | Возвращает представление всех ключей |
| `values()` | `dict_values` | Возвращает представление всех значений |
| `items()` | `dict_items` | Возвращает представление всех пар ключ-значение |
| `pop(key, default=None)` | значение | Удаляет и возвращает значение по ключу |
| `popitem()` | `tuple` | Удаляет и возвращает последнюю пару ключ-значение |
| `clear()` | `None` | Удаляет все элементы из словаря |
| `update(other)` | `None` | Обновляет словарь парами из другого словаря или итерируемого объекта |
| `setdefault(key, default=None)` | значение | Возвращает значение по ключу или устанавливает и возвращает значение по умолчанию |
| `copy()` | `dict` | Возвращает неглубокую копию словаря |

```python
my_dict = {'a': 1, 'b': 2, 'c': 3}
print(my_dict.get('a'))           # 1
print(my_dict.get('z', 'default')) # 'default'
print('a' in my_dict)              # True
print(1 in my_dict.values())       # True
print(('a', 1) in my_dict.items()) # True
```

## Встроенные функции обработки коллекций

### Функция `len()`

Возвращает количество элементов в коллекции. Для словаря считает пары ключ-значение как один элемент.

```python
print(len([1, 2, 3]))        # 3
print(len({'a': 1, 'b': 2})) # 2
print(len('abc'))            # 3
```

### Функция `min()`

Возвращает минимальный элемент коллекции. Работает для числовых и строковых значений.

```python
print(min([3, 1, 2]))           # 1
print(min(['c', 'a', 'b']))     # 'a'
print(min({1, 2, 3}.values())) # 1
```

### Функция `max()`

Возвращает максимальный элемент коллекции. Работает для числовых и строковых значений.

```python
print(max([3, 1, 2]))           # 3
print(max(['c', 'a', 'b']))     # 'c'
print(max({1, 2, 3}.values())) # 3
```

### Функция `sum()`

Суммирует все элементы коллекции, если они числовые. Принимает опциональный параметр `start` для начального значения.

```python
print(sum([1, 2, 3]))              # 6
print(sum([1, 2, 3], start=10))    # 16
print(sum({1, 2, 3}.values()))     # 6
```

### Функция `sorted()`

Возвращает отсортированный список элементов коллекции. Исходная коллекция не изменяется.

```python
print(sorted([3, 1, 2]))              # [1, 2, 3]
print(sorted(['c', 'a', 'b']))        # ['a', 'b', 'c']
print(sorted([3, 1, 2], reverse=True)) # [3, 2, 1]
```

### Функция `reversed()`

Возвращает итератор в обратном порядке. Работает только для индексированных коллекций.

```python
print(list(reversed([1, 2, 3])))  # [3, 2, 1]
print(list(reversed('abc')))      # ['c', 'b', 'a']
```

### Функция `enumerate()`

Возвращает итератор пар (индекс, элемент). Полезна при необходимости получить индекс в цикле.

```python
for index, value in enumerate(['a', 'b', 'c']):
    print(index, value)
# 0 a
# 1 b
# 2 c
```

### Функция `zip()`

Объединяет несколько итерируемых объектов в пары элементов. Длина результата определяется самым коротким объектом.

```python
keys = ['a', 'b', 'c']
values = [1, 2]
print(list(zip(keys, values)))  # [('a', 1), ('b', 2)]

my_dict = dict(zip(keys, values))
print(my_dict)  # {'a': 1, 'b': 2}
```

### Функция `all()`

Возвращает `True`, если все элементы коллекции истинны (или коллекция пуста).

```python
print(all([True, True, True]))   # True
print(all([True, False, True]))  # False
print(all([]))                   # True
```

### Функция `any()`

Возвращает `True`, если хотя бы один элемент коллекции истинен.

```python
print(any([False, False, True]))  # True
print(any([False, False, False])) # False
print(any([]))                    # False
```

## Общие операции с коллекциями

### Оператор `in` и `not in`

Проверяет принадлежность элемента коллекции.

```python
my_list = ['a', 'b', 'c']
print('a' in my_list)      # True
print('z' in my_list)      # False
print('z' not in my_list)  # True

my_dict = {'a': 1, 'b': 2}
print('a' in my_dict)              # True (поиск по ключам)
print('a' in my_dict.keys())       # True
print(1 in my_dict.values())       # True (поиск по значениям)
print(('a', 1) in my_dict.items()) # True (поиск по парам)
```

### Цикл `for in`

Обход всех элементов коллекции.

```python
my_list = ['a', 'b', 'c']
for element in my_list:
    print(element)

my_dict = {'a': 1, 'b': 2}
for key in my_dict:
    print(key)  # Перебираются только ключи

for key, value in my_dict.items():
    print(key, value)  # Перебираются пары ключ-значение

for value in my_dict.values():
    print(value)  # Перебираются только значения
```

**Важное замечание:** Не изменяйте количество элементов коллекции в теле цикла во время итерации по этой же коллекции. Это может привести к непредсказуемому поведению. Для избежания этого можно итерировать копию:

```python
for element in list(my_list):
    if element == 'b':
        my_list.remove(element)  # Безопасно удаляет элементы из исходного списка
```

### Индексация и срезы

Работают для индексированных коллекций (`list`, `tuple`, `str`)

```python
my_list = ['a', 'b', 'c', 'd', 'e']
print(my_list[0])      # 'a'
print(my_list[-1])     # 'e'
print(my_list[1:3])    # ['b', 'c']
print(my_list[:2])     # ['a', 'b']
print(my_list[2:])     # ['c', 'd', 'e']
print(my_list[::2])    # ['a', 'c', 'e']
```

## Конвертация между типами коллекций

Один тип коллекции можно конвертировать в другой, передав её в функцию создания нужного типа

```python
my_tuple = ('a', 'b', 'a')
my_list = list(my_tuple)           # ['a', 'b', 'a']
my_set = set(my_tuple)             # {'a', 'b'} - теряются дубликаты
my_frozenset = frozenset(my_tuple) # frozenset({'a', 'b'})
```

**Важные замечания при конвертации:**

- При преобразовании в `set` или `frozenset` теряются дублирующие элементы, так как множества содержат только уникальные элементы
- При конвертации индексированной коллекции в неиндексированную теряется информация о порядке элементов
- После конвертации в неизменяемый тип коллекция не может быть изменена

```python
my_list = [1, [2, 3], 4]
my_set = set(my_list)  # TypeError: unhashable type: 'list'
```

### Создание словаря из других коллекций

Создать словарь напрямую из одной коллекции нельзя, но можно использовать `zip()` для объединения ключей и значений:

```python
my_keys = ('a', 'b', 'c')
my_values = [1, 2]
my_dict = dict(zip(my_keys, my_values))
print(my_dict)  # {'a': 1, 'b': 2} - лишние ключи отброшены
```

### Создание строки из коллекции

Используется метод `join()`:

```python
my_tuple = ('a', 'b', 'c')
my_str = ''.join(my_tuple)
print(my_str)  # 'abc'

my_list = ['hello', 'world']
my_str = ' '.join(my_list)
print(my_str)  # 'hello world'
```

### Создание списка из строки

```python
my_str = 'abc'
my_list = list(my_str)
print(my_list)  # ['a', 'b', 'c']
```

#Python #GENERATED
