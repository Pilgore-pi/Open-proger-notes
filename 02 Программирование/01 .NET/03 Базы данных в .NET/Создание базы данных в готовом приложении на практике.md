
Здесь будет пошаговое руководство по наладке базы данных с использованием фреймворка EF Core

## 1 Начальные условия

Допустим, что мы уже имеем готовое приложение с пользовательским интерфейсом, которое взаимодействует с простенькой базой данных, представленной в виде одного файла Excel, где определены 2 таблицы (по одной на каждой странице). Данные считываются и записываются непосредственно в файл Excel, который может открыть любой пользователь ОС, что нарушает ограничения доступа к данным

**User (Пользователь приложения):**

- `string Name`: Имя пользователя приложения
- `string PasswordHash`: Хэш-значение пароля пользователя
- `enum Role`: Роль пользователя, разграничивающая его права в приложении. `enum Role { ReadOnly, Admin }`, роль `ReadOnly` позволяет пользователю только читать данные, роль `Admin` позволяет выполнять **CRUD** (Create, Read, Update, Delete) операции
- `DateTime Changed`: Временная метка, показывающее дату и время последнего изменения данных пользователя

**Employee (Информация о сотруднике):**

Это основная таблица БД, с которой взаимодействует пользователь

- `string PhoneNumber`: Номер телефона
- `string FullName`: Полное имя
- `string Division`: Подразделение организации, к которому относится сотрудник
- `string Post`: Должность работника
- `string Building`: Корпус (где работает сотрудник)
- `int Floor`: Этаж
- `DateTime Changed`: Временная метка, показывающее дату и время последнего изменения

### Структура проекта

В гепотетическом проекте нашего приложения есть 3 каталога:

- `Models`: Модели приложения, классы-обертки над сущностями `User` и `Employee`:
    - `User.cs`
    - `Employee.cs`
- `Services`: Сервисные API для упрощенного доступа к файлу Excel
    - `DataApi.cs`: Логика взаимодействия с Excel
- `Views`
    - `AuthView.xaml`: Форма авторизации и регистрации пользователя
    - `WorkView.xaml`: Основная форма работы с данными о сотрудниках организации

### Пример заполненного файла Excel

Первая страница (Employee):

| Подразделение | ФИО | Должность | Номер телефона | Корпус | Этаж |
|:-|:-|:-|:-|:-|:-|
| Отдел управления | Иванов Сергей Владимирович | начальник управления по безопасности | 6004 | 55 | 1 |
| Отдел управления | Смирнова Анна Петровна | ЗГД по кадрам и соц. вопросам | 6006 | 96 | 1 |
| Отдел управления | Кузнецов Алексей Иванович | ЗГД - управляющий делами | 6017 | 128 | 2 |
| Отдел управления | Попова Марина Александровна | главный инженер | 6020 | 128 | 2 |
| Отдел управления | Волков Дмитрий Сергеевич | зам. главного инженера | +79008002030 | 128 | 2 |
| Отдел информационной безопасности | Лебедева Светлана Викторовна | Главный специалист по безопасности | 6301 | 128 | 1 |
| Отдел строительства | Новиков Михаил Андреевич | зам. начальника управления по стр-ву | 6302 |  |  |
|  | Морозова Елена Николаевна | аудитор | 6303 | 128 | 3 |
| Отдел управления | Федоров Олег Юрьевич | первый зам. директора | 6306 | 128 | 4 |
| Отдел безопасности труда | Васильева Наталья Борисовна | ЗГД по безопасности труда | 6307 | 128 | 4 |
| Отдел информационной безопасности | Соколов Павел Дмитриевич | Специалист по инф. безопасности | 6304 | 128 | 4 |
| Отдел информационной безопасности | Павлова Ирина Владимировна |  | 6308 |  |  |
| 13 цех | Михайлов Виктор Сергеевич | начальник участка | 6007 | 19 | 4 |
| 13 цех | Григорьева Татьяна Ивановна | начальник тех. бюро | 60071 | 19 | 4 |


## 2 Цель

Целью работы является перенести существующие данные в SQL базу данных и обеспечить программное взаимодействие с этой базой. Так как пользователи могут продолжать предоставлять данные в Excel формате, нужно написать конвертер Excel файлов в записи SQL базы данных

## 3 Подготовка проекта

Для использования EF Core потребуется установить несколько пакетов Nuget:

- **`Microsoft.EntityFrameworkCore`:** Основной пакет для EF Core с базовой функциональностью
- **`Microsoft.EntityFrameworkCore.Sqlite`:** Провайдер базы данных, мы будем использовать SQL Lite, так как это легковесная СУБД, подходящая для нашего маленького приложения. Можно использовать других провайдеров: `Microsoft.EntityFrameworkCore.SqlServer`, `Npgsql.EntityFrameworkCore.PostgreSQL` (от стороннего поставщика)
- **`Microsoft.EntityFrameworkCore.Tools`:** Для поддержки миграций и командной строки в разработке (опционально)

Установить пакеты можно через:

- Менеджер пакетов Nuget в используемой IDE (самый простой вариант)
- Консоль диспетчера пакетов:

```powershell
Install-Package Microsoft.EntityFrameworkCore
Install-Package Microsoft.EntityFrameworkCore.SqlServer
Install-Package Microsoft.EntityFrameworkCore.Tools
```

- .NET CLI:

```bash
dotnet add package Microsoft.EntityFrameworkCore
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
```

#MERGE_NOTES
