
## Excel


## CSV

**Загрузка из файла:**

```bsl
&НаКлиенте
Процедура ПрочитатьДанные()
    
    ПрочитанныйФайл = Новый текстовыйДокумент;
    ПрочитанныйФайл.Прочитать("D:\20190227_144335.csv");
    ЗагрузитьДанныеНаСервере(ПрочитанныйФайл);
    
КонецПроцедуры

&НаСервере
Процедура ЗагрузитьДанныеНаСервере(ПрочитанныйФайл)
    
    ДанныеИзФайла = новый ТаблицаЗначений;
    Разделитель = ";";
    
    // Если в файле присутствует шапка таблицы, то считываем ее
    // и разделяем на отдельные значения в массив по символу-разделителю.
    // Используется стандартная функция платформы "СтрРазделить"
    
    //Если в файле не было названий столбцов, то эти команды нужно убрать
    Шапка     = ПрочитанныйФайл.ПолучитьСтроку(1);
    МассивКол = СтрРазделить(Шапка, Разделитель);
    
    // В названии столбцов таблицы значений не допускается
    // пробелов, поэтому их нужно убирать
    
    Для Каждого ИмяСт Из МассивКол Цикл
        ИмяБП = СтрЗаменить(ИмяСт," ","");
        ДанныеИзФайла.Колонки.Добавить(ИмяБП,, ИмяСт);
    КонецЦикла;
    
    Для НомерСтроки=2 по ПрочитанныйФайл.КоличествоСтрок() Цикл
        
        Строка = ПрочитанныйФайл.ПолучитьСтроку(НомерСтроки);
        МассивКол = СтрРазделить(Строка,Разделитель);
        НоваяСтрочка= ДанныеИзФайла.Добавить();
        
        Для НомерСтолбца = 1 по МассивКол.Количество() Цикл
            
            ТекущееЗначение = МассивКол[НомерСтолбца-1];
            ИмяКолонки = ДанныеИзФайла.Колонки[НомерСтолбца-1].Имя;
            НоваяСтрочка[ИмяКолонки] = ТекущееЗначение;
            
        КонецЦикла;
        
    КонецЦикла;
    
КонецПроцедуры

```

**Выгрузка из файла:**

```bsl

Процедура СоздатьCSV(Команда)
    
    ВыгрузитьВCSV("D:\Nomenklatura.csv");
    
КонецПроцедуры

Процедура ВыгрузитьВCSV(имяФайлаCSV)
    
    Разделитель = "|";
    ТаблицаЗначений = Получитьданные();
    Текст = СоздатьДанныеCSV(ТаблицаЗначений, разделитель);
    ЗаписатьCSV(текст,имяФайлаCSV);
    
КонецПроцедуры

Функция ПолучитьДанные()      	
    
    Запрос = Новый Запрос;
    Запрос.Текст =
    "ВЫБРАТЬ
    |    Номенклатура.Код КАК Код,
    |    Номенклатура.Наименование КАК Наименование,
    |    Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
    |    Номенклатура.Родитель КАК Родитель
    |ИЗ
    |    Справочник.Номенклатура КАК Номенклатура";     	
    
    РезультатЗапроса = Запрос.Выполнить().Выгрузить();  
    Возврат РезультатЗапроса;
    
КонецФункции

Функция СоздатьДанныеCSV(ТаблицаЗначений,разделитель)
    
    Текст = "";
    
    Для каждого запись из ТаблицаЗначений Цикл
        
        Если Текст = "" тогда
            Текст = СоздатьЗаголовкиCSV(ТаблицаЗначений,разделитель) + Символы.ПС;   	
        КонецЕсли;
        
        Текст = Текст
            + запись.Код              + разделитель
            + запись.ЕдиницаИзмерения + разделитель
            + запись.Наименование     + разделитель
            + запись.Родитель         + Символы.ПС;
            
    КонецЦикла;
    
    Возврат текст;
    
КонецФункции

Процедура ЗаписатьCSV(текст, имяФайла)                 	
    
    кодировка = КодировкаТекста.Unicode;
    ТекстовыйФайлЗапись = Новый ЗаписьТекста(имяФайла, Кодировка);
    ТекстовыйФайлЗапись.ЗаписатьСтроку(текст);
    ТекстовыйФайлЗапись.Закрыть();
    
КонецПроцедуры

```

## JSON


## XML


## XDTO



## XBase


## COM


## HTTP-сервис



#1С #1С/Интеграция
